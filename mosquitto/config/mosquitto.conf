# Mosquitto Configuration File
# Listener settings
listener 1883
protocol mqtt

# WebSocket support (optional)
listener 9001
protocol websockets

# IMPORTANT: Disable system messages or only allow specific topics
sys_interval 0

# Connection settings
allow_anonymous true
max_connections -1

# Bridge settings
connection zenoh_mqtt_bridge
bridge_protocol_version mqttv311
try_private false
cleansession true
address zenoh-mqtt-bridge:1884

# Topic mappings for bridging
topic sensor/# both 0
topic device/# both 0
topic data/# both 0

# IMPORTANT: Exclude system topics from bridging
# topic $SYS/# out


# Persistence
persistence true
persistence_location /mosquitto/data/

# Logging
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout
log_type all
log_timestamp true
log_timestamp_format %Y-%m-%d %H:%M:%S

# Security (add password in production)
# password_file /mosquitto/config/passwd
acl_file /mosquitto/config/acl.conf

# Connection messages - DISABLE to prevent $SYS topics
connection_messages false

# Retained messages
retained_persistence true

# Quality of Service
max_queued_messages 1000
# max_packet_size 0

# Client ID
persistent_client_expiration 1h

# Autosave interval
autosave_interval 300

